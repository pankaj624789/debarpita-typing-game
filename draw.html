<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Debarpita's Creative Studio</title>

<style>
body{
    text-align:center;
    font-family:Arial;
    margin:0;
    background:linear-gradient(135deg,#00c6ff,#0072ff);
    color:white;
}

.toolbar{
    display:flex;
    flex-wrap:wrap;
    justify-content:center;
    gap:10px;
    padding:10px;
}

canvas{
    background:white;
    border-radius:15px;
    margin-top:10px;
    box-shadow:0 10px 20px rgba(0,0,0,0.3);
    touch-action:none;
}

button,input,select{
    padding:8px 12px;
    border:none;
    border-radius:8px;
    cursor:pointer;
}

.home-btn{
    position:absolute;
    top:15px;
    left:15px;
    background:#ff9800;
    color:white;
}
</style>
</head>

<body>


<h1>üé® Debarpita's Creative Studio üé®</h1>

<div class="toolbar">
üé® <input type="color" id="colorPicker" value="#000000">
üñå <input type="range" id="brushSize" min="1" max="30" value="5">
   <input type="file" accept="image/*" onchange="loadBackground(event)">
<button onclick="setGlitter()">‚ú® Glitter</button>
<button onclick="setEraser()">üßΩ Eraser</button>
<button onclick="setTool('pen')">‚úè Pen</button>
<button onclick="setTool('rect')">‚¨õ Rectangle</button>
<button onclick="setTool('circle')">‚≠ï Circle</button>
<button onclick="setTool('line')">üìè Line</button>
<button onclick="setTool('triangle')">üî∫ Triangle</button>


<select onchange="changeBackground(this.value)">
<option value="white">White</option>
<option value="pink">Pink</option>
<option value="sky">Sky</option>
<option value="space">Space</option>
</select>

<button onclick="toggleMusic()">üéµ Music</button>
<button onclick="saveImage()">üíæ Save</button>
<button onclick="clearCanvas()">üóë Clear</button>
<button onclick="goGallery()">üèÜ Gallery</button>
<button onclick="quitGame()">Quit</button>
</div>

<canvas id="canvas" width="500" height="400"></canvas>

<audio id="bgMusic" loop>
<source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3">
</audio>

<script>
const canvas=document.getElementById("canvas");
const ctx=canvas.getContext("2d");

let drawing=false;
let currentColor="#000000";
let brushSize=5;
let glitter=false;
let musicPlaying=false;
let tool = "pen";
let startX, startY;
let snapshot;

// Mouse
canvas.addEventListener("mousedown", startDraw);
canvas.addEventListener("mousemove", draw);
canvas.addEventListener("mouseup", endDraw);
canvas.addEventListener("mouseleave", stopDraw);

// Touch
canvas.addEventListener("touchstart", startDraw);
canvas.addEventListener("touchmove", drawTouch);
canvas.addEventListener("touchend", endDraw);

function stopDraw(){
drawing=false;
ctx.beginPath();
}

function draw(e){
    if(!drawing) return;

    const rect = canvas.getBoundingClientRect();
    const currentX = (e.touches ? e.touches[0].clientX : e.clientX) - rect.left;
    const currentY = (e.touches ? e.touches[0].clientY : e.clientY) - rect.top;

    if(tool === "pen"){
    ctx.lineWidth = brushSize;
    ctx.lineCap = "round";

    if(glitter){
        // ‚ú® Random glitter colors
        const colors = ["#ff00ff","#00ffff","#ffff00","#ff1493","#00ff00"];
        ctx.strokeStyle = colors[Math.floor(Math.random() * colors.length)];
    } else {
        ctx.strokeStyle = currentColor;
    }

    ctx.lineTo(currentX, currentY);
    ctx.stroke();

    // ‚ú® Extra sparkles
// ‚ú® Extra sparkles (MORE + BETTER)
if(glitter){
    for(let i = 0; i < 15; i++){   // üî• increase sparkle count
        
        const offsetX = (Math.random() - 0.5) * 25;
        const offsetY = (Math.random() - 0.5) * 25;
        const size = Math.random() * 3 + 1;

        const sparkleColors = [
            "#ffffff",
            "#ffff99",
            "#ffccff",
            "#99ffff",
            "#ff99ff"
        ];

        ctx.beginPath();
        ctx.arc(
            currentX + offsetX,
            currentY + offsetY,
            size,
            0,
            Math.PI * 2
        );

        ctx.fillStyle = sparkleColors[Math.floor(Math.random() * sparkleColors.length)];
        
        // ‚ú® Glow effect
        ctx.shadowColor = ctx.fillStyle;
        ctx.shadowBlur = 10;

        ctx.fill();
    }

    // Reset shadow after glitter
    ctx.shadowBlur = 0;
}

    ctx.beginPath();
    ctx.moveTo(currentX, currentY);
    return;
}

    // üî• Restore previous canvas
    ctx.putImageData(snapshot, 0, 0);

    ctx.lineWidth = brushSize;
    ctx.strokeStyle = currentColor;

    if(tool === "rect"){
        ctx.strokeRect(startX, startY, currentX - startX, currentY - startY);
    }

    if(tool === "circle"){
        const radius = Math.sqrt(
            Math.pow(currentX - startX, 2) +
            Math.pow(currentY - startY, 2)
        );
        ctx.beginPath();
        ctx.arc(startX, startY, radius, 0, Math.PI * 2);
        ctx.stroke();
    }

    if(tool === "line"){
        ctx.beginPath();
        ctx.moveTo(startX, startY);
        ctx.lineTo(currentX, currentY);
        ctx.stroke();
    }

    if(tool === "triangle"){
        ctx.beginPath();
        ctx.moveTo(startX, startY);
        ctx.lineTo(currentX, currentY);
        ctx.lineTo(startX - (currentX - startX), currentY);
        ctx.closePath();
        ctx.stroke();
    }
}

function drawTouch(e){
    e.preventDefault();
    draw(e);
}

document.getElementById("colorPicker").addEventListener("input",e=>{
currentColor=e.target.value;
glitter=false;
});

document.getElementById("brushSize").addEventListener("input",e=>{
brushSize=e.target.value;
});

function startDraw(e){
    drawing = true;

    const rect = canvas.getBoundingClientRect();
    startX = (e.touches ? e.touches[0].clientX : e.clientX) - rect.left;
    startY = (e.touches ? e.touches[0].clientY : e.clientY) - rect.top;

    ctx.lineWidth = brushSize;
    ctx.strokeStyle = currentColor;

    if(tool === "pen"){
        ctx.beginPath();
        ctx.moveTo(startX, startY);
    } else {
        snapshot = ctx.getImageData(0, 0, canvas.width, canvas.height);
    }
}
function endDraw(e){
    if(!drawing) return;
    drawing = false;

    const rect = canvas.getBoundingClientRect();
    const endX = (e.changedTouches ? e.changedTouches[0].clientX : e.clientX) - rect.left;
    const endY = (e.changedTouches ? e.changedTouches[0].clientY : e.clientY) - rect.top;

    ctx.lineWidth = brushSize;
    ctx.strokeStyle = currentColor;

    if(tool === "rect"){
        ctx.strokeRect(startX, startY, endX - startX, endY - startY);
    }

    if(tool === "circle"){
        const radius = Math.sqrt(
            Math.pow(endX - startX,2) + Math.pow(endY - startY,2)
        );
        ctx.beginPath();
        ctx.arc(startX, startY, radius, 0, Math.PI*2);
        ctx.stroke();
    }

    if(tool === "line"){
        ctx.beginPath();
        ctx.moveTo(startX, startY);
        ctx.lineTo(endX, endY);
        ctx.stroke();
    }

    if(tool === "triangle"){
        ctx.beginPath();
        ctx.moveTo(startX, startY);
        ctx.lineTo(endX, endY);
        ctx.lineTo(startX - (endX-startX), endY);
        ctx.closePath();
        ctx.stroke();
    }

    ctx.beginPath();
}

function setEraser(){
    tool = "pen";
    glitter = false;
    ctx.globalCompositeOperation = "destination-out";
}

function setGlitter(){
    tool = "pen";   // üî• force pen mode
    glitter = true;
}

function changeBackground(theme){
if(theme==="pink")
canvas.style.background="linear-gradient(135deg,#ff9a9e,#fad0c4)";
else if(theme==="sky")
canvas.style.background="linear-gradient(135deg,#89f7fe,#66a6ff)";
else if(theme==="space")
canvas.style.background="black";
else
canvas.style.background="white";
}

function toggleMusic(){
const music=document.getElementById("bgMusic");
if(musicPlaying){
music.pause();
musicPlaying=false;
}else{
music.play();
musicPlaying=true;
}
}

function addWatermark(){
ctx.font="20px Arial";
ctx.fillStyle="rgba(0,0,0,0.2)";
ctx.fillText("Debarpita üé®",canvas.width-150,canvas.height-20);
}

function saveImage(){
addWatermark();
const image=canvas.toDataURL();
let gallery=JSON.parse(localStorage.getItem("gallery"))||[];
gallery.push(image);
localStorage.setItem("gallery",JSON.stringify(gallery));

const link=document.createElement("a");
link.download="drawing.png";
link.href=image;
link.click();
}

function clearCanvas(){
ctx.clearRect(0,0,canvas.width,canvas.height);
}

function goGallery(){
window.location.href="gallery.html";
}

function loadBackground(event){
    const reader = new FileReader();
    reader.onload = function(){
        const img = new Image();
        img.onload = function(){
            ctx.clearRect(0,0,canvas.width,canvas.height);
            ctx.drawImage(img,0,0,canvas.width,canvas.height);
        }
        img.src = reader.result;
    }
    reader.readAsDataURL(event.target.files[0]);
}

function setTool(selectedTool){
    tool = selectedTool;
    glitter = false;
    ctx.globalCompositeOperation = "source-over"; // üî• restore normal mode
}

function quitGame() {
  const confirmQuit = confirm("Are you sure you want to quit?");
  if (confirmQuit) {
    window.location.href = "index.html";
  }
}

</script>

</body>
</html>