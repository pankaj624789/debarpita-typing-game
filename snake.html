<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Real Snake Game</title>

<style>
body{
    margin:0;
    font-family:Arial;
    text-align:center;
    background:linear-gradient(135deg,#11998e,#38ef7d);
    color:white;
}
h1{margin-top:15px;}
#score{font-size:20px;margin-bottom:10px;}
canvas{
    background:#111;
    border-radius:12px;
    box-shadow:0 0 20px rgba(0,0,0,0.5);
}
button{
    padding:10px 20px;
    border:none;
    border-radius:8px;
    font-size:16px;
    margin-top:15px;
    cursor:pointer;
    background:#ff9800;
    color:white;
}

.mobile-controls{
    margin-top:20px;
    display:grid;
    grid-template-columns: repeat(3, 70px);
    gap:10px;
    justify-content:center;
}

.mobile-controls button{
    width:70px;
    height:70px;
    font-size:26px;
    border:none;
    border-radius:12px;
    background:#ff9800;
    color:white;
    box-shadow:0 4px 8px rgba(0,0,0,0.3);
}

.mobile-controls button:active{
    background:#e68900;
}
</style>
</head>

<body>

<h1>üêç Real Snake Game</h1>
<div id="score">Score: 0</div>
<canvas id="game" width="400" height="400"></canvas>
<div class="mobile-controls">
    <div></div>
<button onclick="changeDirection('up')">‚¨Ü</button>
<button onclick="changeDirection('left')">‚¨Ö</button>
<button onclick="changeDirection('down')">‚¨á</button>
<button onclick="changeDirection('right')">‚û°</button>
</div>
<br>
<button onclick="restartGame()">Restart</button>
<button onclick="quitGame()">Quit</button>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
// üîä SOUND SYSTEM (Mobile Safe)
let audioCtx;

function initAudio(){
    if(!audioCtx){
        audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    }
    if(audioCtx.state === "suspended"){
        audioCtx.resume();
    }
}

function playSound(frequency, duration, type="sine"){
    if(!audioCtx) return;

    const oscillator = audioCtx.createOscillator();
    const gainNode = audioCtx.createGain();

    oscillator.type = type;
    oscillator.frequency.value = frequency;
    oscillator.connect(gainNode);
    gainNode.connect(audioCtx.destination);

    oscillator.start();

    gainNode.gain.setValueAtTime(0.2, audioCtx.currentTime);
    gainNode.gain.exponentialRampToValueAtTime(
        0.001,
        audioCtx.currentTime + duration
    );

    oscillator.stop(audioCtx.currentTime + duration);
}
const box = 20;
let snake, food, direction, score, game, speed;

function changeDirection(dir){
    if(dir==="up" && direction!=="down") direction="up";
    if(dir==="down" && direction!=="up") direction="down";
    if(dir==="left" && direction!=="right") direction="left";
    if(dir==="right" && direction!=="left") direction="right";
}
function initGame(){
    snake = [{x:200,y:200}];
    direction = null;
    score = 0;
    speed = 250;
    document.getElementById("score").innerText="Score: "+score;

    food = randomFood();
    clearInterval(game);
    game = setInterval(draw, speed);
}

function randomFood(){
    return {
        x: Math.floor(Math.random()*20)*box,
        y: Math.floor(Math.random()*20)*box
    };
}



function drawCircle(x,y,color,radius=9){
    ctx.fillStyle=color;
    ctx.beginPath();
    ctx.arc(x+10,y+10,radius,0,Math.PI*2);
    ctx.fill();
}

function drawSnake(){
    for(let i=0;i<snake.length;i++){
        drawCircle(snake[i].x, snake[i].y, i===0?"#00ff88":"#00cc66");
    }

    // Eyes
    let head = snake[0];
    ctx.fillStyle="white";
    ctx.beginPath();
    ctx.arc(head.x+6, head.y+6, 3, 0, Math.PI*2);
    ctx.arc(head.x+14, head.y+6, 3, 0, Math.PI*2);
    ctx.fill();
}

function draw(){
    ctx.fillStyle="#111";
    ctx.fillRect(0,0,400,400);

    drawSnake();
    drawCircle(food.x, food.y, "red",7);

    let headX = snake[0].x;
    let headY = snake[0].y;

    if(direction==="up") headY-=box;
    if(direction==="down") headY+=box;
    if(direction==="left") headX-=box;
    if(direction==="right") headX+=box;

    if(headX===food.x && headY===food.y){
        score++;
        playSound(600, 0.1, "square");
        document.getElementById("score").innerText="Score: "+score;
        food=randomFood();
        if(speed>60){
            speed-=5;
            clearInterval(game);
            game=setInterval(draw,speed);
        }
    }else{
        snake.pop();
    }

    const newHead={x:headX,y:headY};

    if(
        headX<0||headY<0||
        headX>=400||headY>=400||
        collision(newHead,snake)
    ){
        clearInterval(game);
        playSound(150, 0.5, "sawtooth"); // Game over sound
setTimeout(()=>{
    alert("Game Over! Score: "+score);
},300);
    }

    snake.unshift(newHead);
}

function collision(head,array){
    return array.some(segment=>segment.x===head.x && segment.y===head.y);
}

function restartGame(){
    initGame();
}

initGame();

function quitGame() {
  const confirmQuit = confirm("Are you sure you want to quit?");
  if (confirmQuit) {
    window.location.href = "index.html";
  }
}

document.body.addEventListener("touchstart", initAudio, { once: true });
document.body.addEventListener("click", initAudio, { once: true });

</script>

</body>
</html>